**15 Juillet**
- [ ] ESL-396 Correctement afficher l'eslId dans la page de management des storeArticles
- [x] ESL-429 Rediriger vers la page d'une ESL au clic sur sa ligne de la table
    - [x] Modifs dans le component puisque la lib gère les lignes depuis TS pas html : 
    ```
    columnDefs = [
        { headerName: 'ID ESL', field: 'id_esl',  headerClass: 'bg-gray-800 text-white font-semibold', cellClass: 'clickable-cell', 
        onCellClicked: (params: any) => this.redirectToManagement(params.data.id_esl, params.data.width, params.data.height)},
        { headerName: 'Style associé', field: 'style.name',  headerClass: 'bg-gray-800 text-white font-semibold', cellClass: 'clickable-cell', 
        onCellClicked: (params: any) => this.redirectToManagement(params.data.id_esl, params.data.width, params.data.height)},
        { headerName: 'Largeur', field: 'width' ,  headerClass: 'bg-gray-800 text-white font-semibold', cellClass: 'clickable-cell', 
        onCellClicked: (params: any) => this.redirectToManagement(params.data.id_esl, params.data.width, params.data.height)},
        { headerName: 'Hauteur', field: 'height',  headerClass: 'bg-gray-800 text-white font-semibold', cellClass: 'clickable-cell', 
        onCellClicked: (params: any) => this.redirectToManagement(params.data.id_esl, params.data.width, params.data.height)},
        { headerName: 'Connexion', field: 'average_rssi', cellRenderer: this.signalRenderer,  headerClass: 'bg-gray-800 text-white font-semibold', cellClass: 'clickable-cell', 
        onCellClicked: (params: any) => this.redirectToManagement(params.data.id_esl, params.data.width, params.data.height)},
        { headerName: 'Niveau de batterie', field: 'power', valueFormatter: ({ value }: ValueFormatterParams) => `${value}%`,  headerClass: 'bg-gray-800 text-white font-semibold', cellClass: 'clickable-cell', 
        onCellClicked: (params: any) => this.redirectToManagement(params.data.id_esl, params.data.width, params.data.height)},
        {headerName: 'Opérations', field: 'id_esl', cellRenderer: this.actionRenderer, autoHeight: true,  headerClass: 'bg-gray-800 text-white font-semibold'}
    ];
    ```
    et ajout de stopPropagation pour éviter de trigger l'action du row en plus du bouton : 
    ```
    actionRenderer = (params: any): string => {
        const esl = params.data;
        const dissocBtn = esl.store_article?.id
            ? `<button class="bg-orange-500 text-white px-2 py-1 rounded" onclick="angularComponentRef.dissociateEsl('${esl.id_esl}')">Dissocier</button>`
            : '';

        return `
        <div class="flex flex-col  ">
        <button class="bg-gray-300 px-2 py-1 rounded" onclick="event.stopPropagation(); angularComponentRef.redirectToManagement('${esl.id_esl}', ${esl.width}, ${esl.height})">Modifier</button>
        <button class="bg-green-500 text-white px-2 py-1 rounded" onclick="event.stopPropagation(); angularComponentRef.blinkEsl('${esl.id_esl}', '#00FF00')">Clignoter</button>
        ${dissocBtn}
        </div>`;
    };
    ```
- [ ] ESL-397 Refaire le message d'erreur d'assignation de code article déjà assigné avec une nouvelle ErreurUtilisateur
- [ ] ESL-404 Rediriger vers la page d'un Style au clic sur sa ligne de la table
- [ ] ESL-392 Rediriger vers la page d'un storeArticle au clic sur sa ligne de la table
- [ ] ESL-420 Ajouter un message d'erreur "Veuillez renseigner un nom" à la création de style si le nom n'est pas renseigné
- [x] ESL-424 Ajouter une infobox de confirmation à la suppression de style
    - [x] nouvelle modale : 
    ```
    import { Component, Inject } from '@angular/core';
    import { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';

    @Component({
    selector: 'app-confirm-dialog',
    standalone: true,
    template: `
        <div class="p-4 text-gray-900">
        <h2 class="text-lg font-semibold mb-4">Confirmation</h2>
        <p class="mb-6">Voulez-vous supprimer le style <strong>{{ data.styleName }}</strong> ?</p>
        <p class="mb-6"> <strong>Attention !</strong> Cette action supprimera également les templates associés.</p>

        <div class="flex justify-end space-x-3">
            <button
            class="px-4 py-2 rounded-md bg-gray-300 text-gray-800 hover:bg-gray-400"
            (click)="onCancel()"
            >
            Annuler
            </button>
            <button
            class="px-4 py-2 rounded-md bg-red-600 text-white hover:bg-red-700"
            (click)="onConfirm()"
            >
            Supprimer
            </button>
        </div>
        </div>
    `
    })
    export class ConfirmDialogComponent {
    constructor(
        public dialogRef: MatDialogRef<ConfirmDialogComponent>,
        @Inject(MAT_DIALOG_DATA) public data: { styleName: string }
    ) {}

    onCancel(): void {
        this.dialogRef.close(false);
    }

    onConfirm(): void {
        this.dialogRef.close(true);
    }
    }
    ```
- [x] ESL-414 Repasser sur le visuel du menu management ESL (couleurs, orthographe, alignement)
    - [x] html : 
    ```
    <div>
        <p class="text-6xl mt-3 title text-center">Configuration</p>

        <div class="grid grid-cols-3 content-center">
            <div class="flex">
                <p class="text-size-esl-information ">ID ESL : </p> <p class="text-size-esl-information font-bold">{{ this.idEsl}}</p>
            </div>
            <div class="flex">
                <p class="text-size-esl-information ">Dimensions : </p> <p class="text-size-esl-information font-bold">{{ this.width}} x {{ this.height}}</p>
            </div>
            <div class="flex text-size-esl-information  ">  Statut : <p *ngIf="isOnline(this.esl.timestamp_rssi)" class="text-green-500" >En ligne </p> <p *ngIf="!isOnline(this.esl.timestamp_rssi)" class="text-red-500"  >Hors-ligne</p></div>
            <div class="flex text-size-esl-information">
                <p>RSSI : </p>
            <div
                    class=" text-sm text-gray-500 whitespace-nowrap"
                    *ngIf="analyzeSignal(esl.average_rssi) === 'good' && isOnline(this.esl.timestamp_rssi)"
            >
                <img
                        ngSrc="app/assets/signal_wifi_good.png"
                        alt="signal_wifi_good.png"
                        height="40"
                        width="40"
                />
            </div>
            <div
                    class=" pl-3 text-sm text-gray-500 whitespace-nowrap"
                    *ngIf="analyzeSignal(esl.average_rssi) === 'full' && isOnline(this.esl.timestamp_rssi) "
            >
                <img
                        ngSrc="app/assets/signal_wifi_full.png"
                        alt="signal_wifi_full.png"
                        height="40"
                        width="40"
                />
            </div>
            <div
                    class="pl-3 text-sm text-gray-500 whitespace-nowrap"
                    *ngIf="analyzeSignal(esl.average_rssi) === 'fair' && isOnline(this.esl.timestamp_rssi) "
            >
                <img
                        ngSrc="app/assets/signal_wifi_fair.png"
                        alt="signal_wifi_fair.png"
                        height="40"
                        width="40"
                />
            </div>
            <div
                    class="pl-3 text-sm text-gray-500 whitespace-nowrap"
                    *ngIf="analyzeSignal(esl.average_rssi) === 'poor' && isOnline(this.esl.timestamp_rssi) "
            >
                <img
                        ngSrc="app/assets/signal_wifi_poor.png"
                        alt="signal_wifi_poor.png"
                        height="40"
                        width="40"
                />
            </div>
            <div
                    class="pl-3 text-sm text-gray-500 whitespace-nowrap"
                    *ngIf="analyzeSignal(esl.average_rssi) === 'disconnected'  || !isOnline(this.esl.timestamp_rssi) "
            >
                <img
                        ngSrc="app/assets/signal_wifi_disconnected.png"
                        alt="signal_wifi_disconnected.png"
                        height="40"
                        width="40"
                />
            </div>
            </div>
            <div>

                <p class="text-size-esl-information">Batterie : {{esl.power}} %</p>
            </div>

            <div class="flex" *ngIf="this.esl.store_article != null" >
                <p class="text-size-esl-information"  >Produit associé : </p> <p class=" ml-2 text-size-esl-information font-bold">{{this.esl.store_article.name}}</p>
                
            </div>
        </div>
        <div class="grid grid-cols-4 gap-9 px-[10%] mt-14">
            <button class="bg-red-500 hover:bg-red-700 h-16 text-white grid grid-cols-2 pl-[20%] pr-[34%]  font-bold py-3 pt-4 rounded" (click)="onDisableSubmit()">


                <svg xmlns="http://www.w3.org/2000/svg" height="35px" viewBox="0 -960 960 960" width="35px" fill="#FFFFFF" >
                    <path d="M280-880h400l-80 280h160L635.67-419.67 588-467.33l45.33-66h-102L515.67-549 592-813.33H346.67v104.66L280-775.33V-880ZM400-80v-320H280v-184.67l-221-221 47.67-47.66 746.66 746.66L805.67-59 557.33-307.33 400-80Zm67-508.33Z"/>
                </svg>
                <p class=" text-xl">Désactiver</p>

            </button>
            <button class="bg-gray-500 hover:bg-gray-700 h-16 pl-[20%] pr-[34%] text-white grid grid-cols-2 font-bold py-2 pt-4 rounded" (click)="onEslIsBrokenSumit()">
                <svg xmlns="http://www.w3.org/2000/svg" height="35px" viewBox="0 -960 960 960" width="35px" fill="#FFFFFF"><path d="M267.33-120q-27.5 0-47.08-19.58-19.58-19.59-19.58-47.09V-740H160v-66.67h192V-840h256v33.33h192V-740h-40.67v553.33q0 27-19.83 46.84Q719.67-120 692.67-120H267.33Zm425.34-620H267.33v553.33h425.34V-740Zm-328 469.33h66.66v-386h-66.66v386Zm164 0h66.66v-386h-66.66v386ZM267.33-740v553.33V-740Z"/>
                </svg>
                <p class="text-xl">Défectueuse</p>
            </button>
            <button class="bg-green-500 pl-[20%] pr-[20%] grid grid-cols-2 hover:bg-green-700 h-16 text-white font-bold  pt-4 rounded" (click)="blinkEsl()">

                <svg xmlns="http://www.w3.org/2000/svg" height="40px" viewBox="0 -960 960 960" width="40px" fill="#FFFFFF" class="mb-3">
                    <path d="M480-346.67q55.33 0 94.33-39t39-94.33q0-55.33-39-94.33t-94.33-39q-55.33 0-94.33 39t-39 94.33q0 55.33 39 94.33t94.33 39Zm0 66.67q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-446.67H40v-66.66h160v66.66Zm720 0H760v-66.66h160v66.66ZM446.67-760v-160h66.66v160h-66.66Zm0 720v-160h66.66v160h-66.66ZM260-655.33l-100.33-97 47.66-49 96 100-43.33 46Zm493.33 496-97.66-100.34 45-45.66 99.66 97.66-47 48.34Zm-98.66-541.34 97.66-99.66 49 47L702-656l-47.33-44.67ZM159.33-207.33 259-305l46.33 45.67-97.66 99.66-48.34-47.66ZM480-480Z"/>
                </svg>

            <p class="text-xl w-full">Clignoter</p>
            </button>
            <button class="bg-blue-500 hover:bg-blue-700 h-16 pl-[20%] pr-[34%] text-white grid grid-cols-2 font-bold py-2 pt-4 rounded" (click)="forceRefresh()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" height="35px" width="35px" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" >
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99" />
                </svg>

                <p class="text-xl">Rafraîchir</p>
            </button>

        </div>

    </div>
    <div class="mt-28 grid grid-cols-3 gap-5">
        <div>
        <div class="management-container mt-3 w-[100%]">
            <p class="text-2xl text-center">Associer un produit</p>
            <div>
                <label for="barcode">Code barre:</label>
                <input class="mb-3 border border-gray-300 rounded-lg p-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 text-gray-900 text-sm"
                        type="text"
                        id="barcode"
                        [(ngModel)]="barcode"
                        name="barcode"
                        required
                />
            </div>
            <button class="bg-[#E06E40] hover:bg-[#CB633B] h-16 w-full text-white  font-bold py-2 pt-4 rounded" (click)="onAssociateSubmit($event)">
                <p class="">Valider</p>
            </button>
        </div>
        </div>
        <div class="management-container mt-3 w-[100%]">



            <p class="text-center text-2xl">Définir un style </p>

            <div class="mt-2 mb-6">
                <div class="ml-2 flex">
                    <select id="currencySelect" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg  focus:ring-blue-500 focus:border-blue-500 block h-14  p-2.5 w-full" (change)="changeStyle($event)"  >
                        <option value="" disabled selected hidden>Choisissez un style</option>
                        <option *ngFor="let style of this.styles" [value]="style.name">{{style.name}}</option>
                    </select>
                </div>
            </div>
            <button
            [ngClass]="styleName ? 'bg-green-500 hover:bg-green-600' : 'bg-gray-300 hover:bg-gray-400'"
            class="h-16 w-full text-white mb-4 font-bold py-2 pt-4 rounded"
            [disabled]="!styleName"
            (click)="onSetStyleSubmit()"
            >
                <p class="">Enregistrer</p>
            </button>

            <mat-divider></mat-divider>

            <p class="text-2xl text-center">Charger une image</p>
            <label for="file-upload" class="flex mt-2 w-full px-[25%]  py-2 bg-gray-300 text-white text-md font-medium rounded cursor-pointer hover:bg-gray-400">
                <div class=" mt-2 flex text-center pl-5 ">
                    <p class="flex" ><svg xmlns="http://www.w3.org/2000/svg" height="30px" viewBox="0 -960 960 960" width="30px" class="mr-3" fill="#FFFFFF">
                        <path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm40-80h480L570-480 450-320l-90-120-120 160Zm-40 80v-560 560Z"/></svg>
                        </p> <p>Sélectionner une image</p>
                </div>

            </label>
            <input id="file-upload" type="file" class="hidden" (change)="onImageSelected($event)" />

            <p class="mt-2">Fichier sélectionné: {{this.fileName}} </p>
            <button class="bg-[#E06E40] mt-2 hover:bg-[#CB633B] h-16 w-full text-white  font-bold py-2 pt-4 rounded" (click)="onSubmitImage()">
                <p class="">Envoyer</p>

            </button>
        </div>
        <div class="management-container mt-3 w-[100%] h-[46%] ">
            <p class="text-center text-2xl">Aperçu</p>
            <button class="bg-[#E06E40] mt-20 hover:bg-[#CB633B] h-16 w-full text-white  justify-end font-bold py-2 pt-4 rounded " (click)="openDialogPreview()">
                <p class="">Afficher l'aperçu</p>

            </button>
        </div>

        <canvas id="canvas" class="hidden" width="800" height="400"></canvas>

    </div>
    ```
    - [x] Refonte onImageSubmit dans le component : 
    ```
    onSubmitImage(): void {
        if (!this.base64Image) {
        this.snackBar.open('Veuillez sélectionner une image', 'Fermer', {
            duration: 3000,
            panelClass: ['error-snackbar']
        });
        return;
        }

        if (this.idEsl && this.base64Image) {
        const payload: UpdatePictureEslDto = { picture: this.base64Image };
        this.eslService.updateImage(this.idEsl, payload).subscribe({
            next: () => {
            this.snackBar.open('Image mise à jour avec succès!', 'Fermer', {
                duration: 2000,
                panelClass: ['success-snackbar']
            });
            },
            error: (err) => {
            this.snackBar.open('Échec de la mise à jour de l\'image: ' + err.message, 'Fermer', {
                duration: 3000,
                panelClass: ['error-snackbar']
            });
            },
        });
        } else {
        this.snackBar.open('Paramètres ESL invalides. Veuillez vérifier l\'ID.', 'Fermer', {
            duration: 3000,
            panelClass: ['error-snackbar']
        });
        }
    }
    ``` 
- [ ] ESL-376 Au démarrage des services docker, envoyer une requête pour redémarrer les services de la base ESLs
    - [x] trigger un restart des bases 
    ```
    Invoke-WebRequest -Uri "http://192.168.1.111:8080/api/restart-app" -Method GET
    ```
    à changer l'adresse ip par une variable et répéter l'action pour chaque ligne dans le fichier base.txt.