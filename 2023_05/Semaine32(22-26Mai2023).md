**22 Mai**
- [ ] Poursuite Predict
    - [ ] MàJ du fichier excel sur les tests
    - [ ] Up du coverage
        - [ ] Front-end
            - [ ] Pages
                - [x] Création de la branche test/KP-259-265_front_unit_test_all_pages
                - [ ] Test de la page cop-dialog
                    - [x] Création du fichier et assert exists
                    - [x] Résolution du fail des tests : 
                    ```
                    Cannot use spyOn on a primitive value; undefined given
                    ```
                    Rechercher un fix
                        - [x] Check de (https://stackoverflow.com/questions/69050482/cannot-spyon-on-a-primitive-value-undefined-given)
                        - [x] Demande à gpt qui dit d'initialiser les variables comme suit dans le beforeEach() :
                        ```
                        kmoBoxesService = TestBed.inject(KmoBoxesService);
                        snackBar = TestBed.inject(MatSnackBar);
                        ```
                    - [ ] Résolution du fail des tests : 
                        - [x] Update de rxjs dans le front : ```npm install rxjs@^7.0.0 --legacy-peer-deps```
                        - [ ] Résolution de :
                        ```
                        ● CopDialogComponent › should retrieve KmoBox data on ngOnInit

                        expect(jest.fn()).toHaveBeenCalledWith(...expected)

                        Expected: "ABC123"
                        Received: undefined

                        Number of calls: 1
                        ```
                - [x] Test de la page cop
                    - [x] Open dialog box : 
                    ```
                    it('should open the dialog', () => {
                        const openDialogSpy = jest.spyOn(dialogMock, 'open').mockReturnValue({} as MatDialogRef<any>);

                        const mockBox = {
                        mac: '123',
                        datetime: '2023-05-11T12:00:00Z',
                        uptime: 500,
                        firmwareVersion: 1.2,
                        checkoutNumber: 3,
                        isOutOfOrder: false,
                        };

                        component.openDialog(mockBox);

                        expect(openDialogSpy).toHaveBeenCalledWith(CopDialogComponent, { data: mockBox });
                    });
                    ```
                    - [x] Tester le store à l'init:
                    ```
                    it('should get the store on ngOnInit', () => {
                        const getStoreByIdSpy = jest.spyOn(storeService, 'getStoreById').mockReturnValue(of(store));
                        component.ngOnInit();
                        expect(getStoreByIdSpy).toHaveBeenCalledWith('testId');
                        expect(component.store).toEqual(store);
                    });
                    ```
                    - [x] Tester l'update de la gateway : 
                    ```
                      it('should update gateway to "Hors-service"', () => {
                        component.gatewayIsHs();
                        expect(gatewayService.updateGateway).toHaveBeenCalledWith(store.gateway.mac, { isBroken: true });
                        expect(storeService.getStoreById).toHaveBeenCalledWith('testId');
                        expect(component.isBroken).toBe(true);
                    });

                    it('should update gateway to "Fonctionne"', () => {
                        jest.spyOn(gatewayService, 'updateGateway').mockReturnValue(of({}));
                        jest.spyOn(storeService, 'getStoreById').mockReturnValue(of({ ...store, gateway: { ...store.gateway, isBroken: false } }));
                        component.gatewayIsGood();
                        expect(gatewayService.updateGateway).toHaveBeenCalledWith(store.gateway.mac, { isBroken: false });
                        expect(storeService.getStoreById).toHaveBeenCalledWith('testId');
                        expect(component.isBroken).toBe(false);
                    });
                    ```
                - [x] Test de la page home
                - [ ] Test de la page home cop
                - [ ] Test de la page store
                - [ ] Test de la page user
            - [ ] Components
                - [ ] Création de la branche
                - [ ] Test du component administration
                - [ ] Test du component cop
                - [ ] Test du component cop dialog
                - [ ] Test du component home
                - [ ] Test du component home cop
                - [ ] Test du component gateway disconnected
                - [ ] Test du component store
                - [ ] Test du component user
        - [ ] Back-end
            - [ ] Passe controllers
                - [ ] Création de la branche
                - [ ] fichier gateways.controller.ts
                    - [ ] getAllUnassigned
                    - [ ] getAll
                    - [ ] updateGateway
            - [ ] Statements
            - [ ] Functions


**23 Mai**
- [ ] Poursuite Predict
    - [ ] MàJ du fichier excel sur les tests
    - [ ] Up du coverage
        - [ ] Front-end
            - [ ] Pages
                - [ ] Test de la page cop-dialog
                    - [x] Création du fichier et assert exists
                    - [ ] Résolution du fail des tests : 
                        - [ ] Résolution de :
                        ```
                        ● CopDialogComponent › should retrieve KmoBox data on ngOnInit

                        expect(jest.fn()).toHaveBeenCalledWith(...expected)

                        Expected: "ABC123"
                        Received: undefined

                        Number of calls: 1
                        ```
                - [x] Test de la page home cop
                    - [x] Résolution du fail des tests : 
                        - [x] Résolution de :
                        ```
                          ● HomeCopComponent › should call storeService.getStores method on pageChangeEvent

                            TypeError: element.animate is not a function

                            54 |     jest.spyOn(storeService, 'getStores').mockReturnValue(of(mockPaginatedData));
                            55 |
                            > 56 |     fixture.detectChanges();
                        ```
                        - [x] Ajout dans les imports de :
                        ```
                        BrowserAnimationsModule,
                        NoopAnimationsModule
                        ```
                - [ ] Test de la page store
                - [ ] Test de la page user
            - [ ] Components
                - [ ] Création de la branche
                - [ ] Test du component administration
                - [ ] Test du component cop
                - [ ] Test du component cop dialog
                - [ ] Test du component home
                - [ ] Test du component home cop
                - [ ] Test du component gateway disconnected
                - [ ] Test du component store
                - [ ] Test du component user
        - [ ] Back-end
            - [ ] Passe controllers
                - [ ] Création de la branche
                - [ ] fichier gateways.controller.ts
                    - [ ] getAllUnassigned
                    - [ ] getAll
                    - [ ] updateGateway
            - [ ] Statements
            - [ ] Functions